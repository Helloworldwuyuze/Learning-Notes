# <center> 暑假 $\text{Day 26}$ 模拟赛 </center>

#### <p align="right"> ——一川烟草，满城风絮，梅子黄时雨 </p>

众所周知，一场比赛需要一张头图

![](head.png)


|| 构造 | 数据 | 卡 | 爆了 |
|:-:| :----: | :--------: | :----------------: | :--------: |
|**英文名称**| $\text{construct}$ | $\text{information}$ | $\text{card}$ | $\text{boom}$ |
|**输入文件名**| $\text{construct.in}$ | $\text{information.in}$ | $\text{card.in}$ | $\text{boom.in}$ |
|**输出文件名**| $\text{construct.out}$ | $\text{information.out}$ | $\text{card.out}$ | $\text{boom.out}$ |
|**时间限制**|$\text{1s}$|$\text{1s}$|$\text{2s}$|$\text{1s}$|
|**空间限制**|$\text{512MB}$|$\text{512MB}$|$\text{512MB}$|$\text{512MB}$|
|**测试点数量**|$20$|$20$|$25$|$30$|
|**测试点是否等分**|是|是|是|否|

</center>

## 说明

编译环境使用 `C++14`。

题目顺序为了迎合题目名称，并非按照难度升降。个人主观排序为 $\text{C<A<D<B}$，大家根据自己情况作答。

**祝大家做题愉快！**

## A. 构造 （construct）

### 题目背景

> 众所周知，我们出题的时候总需要构造情景。

### 题目描述

$\text{Helloworldwuyuze}$ 在某款某个开放性世界游戏中制造了一个印钞机。这个印钞机可以印刷不同面值的货币。其中最小的一定是 $1$ 元的货币。对于货币面值构成的有限序列 $q_n$，一定满足 $q_{n+1} = k_nq_n$，其中 $i\in[1,n)\cap \mathbb{Z},k_n\in [2,\infty)\cap \mathbb{Z}$。现在 $\text{Helloworldwuyuze}$ 需要还清贷款。其中第 $i$ 笔贷款有需要 $a_i$ 元。它必须使用自己创造的钞票还，而且不允许找零，求如何制造钞票才能使得付款时使用的钞票总数最少。

### 输入描述

第一行一个整数 $n$ 表示贷款的数量。接下来一行 $n$ 个整数表示每个贷款需要多少钱。

### 输出描述

第一行一个整数表示最少需要的钞票数量，接下来一行若干数表示钞票的面值。

### 样例输入输出

#### 输入

```
2
25 102
```

#### 输出

```
4
3
1 25 100
```

### 样例解释

当选择的面值为 $1, 25,100$ 时，需要 $4$ 张钞票。能够证明这时最少的情况。

### 数据范围

对于 $30\%$ 的数据，满足 $a_i\le 10$。

对于 $90\%$ 的数据，满足 $a_i\le 10^5$。

对于 $100\%$ 的数据，满足 $a_i\le 10^6,n\le 50$。

### 提示

本题开启 $\text{Special Judge}$。

请一定按照从小到大的顺序输出货币，否则 $\text{Special Judge}$ 将无法得出正确的判断。

## B 数据（Information）

### 题目背景

> $\text{Helloworldwuyuze}$ 正在练习 **【模板】线段树0**。

### 题目描述

有一天，$\text{Helloworldwuyuze}$ 正在做线段树板子，题目是这样的：

> 给定一个长度为 $n$ 的序列，每次操作描述为 $l,r$ 表示将区间 $[l,r]$ 中的最大值与最小值交换。最后输出操作后的序列。

做完之后，$\text{Helloworldwuyuze}$ 想把它搬到自己的模拟赛之中，但是他不会造数据了，于是他想让你来帮帮他。

题目会给出序列长度 $n$，以及操作前序列 $a_n$ 和操作后序列 $b_n$，请你帮他造一组数据使得原序列按照构造的操作操作完后得到操作后序列。

### 输入描述

第一行一个数 $n$ 表示序列长度。

第二行和第三行每行 $n$ 个数分别表示 $a_n$ 和 $b_n$。

### 输出描述

第一行一个数 $k$ 表示操作的数量，其中我们要求操作数量必须小于 $10^6$。~~（不然你也输出不出来）~~

接下来 $k$ 行每行两个数表示构造的操作。

### 样例输入输出

#### 输入

```
6
1 3 5 6 4 2
1 2 3 4 5 6
```

#### 输出

```
4
2 3
3 6
2 5
4 5
```

### 样例解释

模拟之后不难得到输出是输入的一组解。

### 数据范围

对于 $10\%$ 的数据，满足 $n\le 10$。

对于 $40\%$ 的数据，满足 $n\le 100$。

对于 $70\%$ 的数据，满足 $n\le 1000$。

对于所有数据，满足 $n\le 10^4$，且保证 $a$ 数列和 $b$ 数列是 $1-n$ 的一个排列。

### 提示

本题开启 $\text{Special Judge}$。

对于评测时卡顿的问题，大家不用紧张，大概率是因为 $\text{Special Judge}$ 使用的是 **【模板】线段树** 的标算，而操作量高达 $10^6$，因此造成卡顿。

## C. 卡（card）

### 题目背景

> $\text{Helloworldwuyuze}$ 曾经喜欢玩 $\text{PVZ}$。

### 题目描述

众所周知，风靡全球的 $\text{PVZ}$ 是一款构思巧妙的塔防游戏，通过摆放植物对僵尸进行攻击。而众所周知，风靡全球的 $\text{PVZ}$ 中有一种植物叫做忧郁菇，它可以攻击周围八格范围内的僵尸。现在，如果我们把地图看成八联通的图，那么它就能够攻击到它一步之内能够到达的点（包括它本身所在的点）。

受到它的启发，$\text{Helloworldwuyuze}$ 也想制作一款塔防游戏。这个游戏的地图并不再是方方正正的方格，而是一张 $n$ 个点 $m$ 条边的地图，每条边的长度为 $1$。而且，他觉得忧郁菇太弱了，于是把忧郁菇的攻击范围变成了两步之内能够到达的所有点。写完这个游戏之后，$\text{Helloworldwuyuze}$ 先用 $k$ 个没有增强的忧郁菇安放在地图上，使得它们的攻击范围覆盖所有点。现在他想用不超过 $k$ 个加强的忧郁菇覆盖整张地图，但是它不知道怎么样放置，于是把问题交给了你。

### 输入描述

第一行三个整数 $n,m,k$，含义见 **题目描述**。

接下来 $m$ 行每行两个数表示一条路径。

### 输出描述

第一行一个字符串表示是否可以完成。如果可以输出 `Possible`，否则输出 `Impossible`。

接下来，如果第一行输出的是 `Possible`，输出一个数 $ans$ 表示你所构造的忧郁菇的个数。

接下来一行 $ans$ 个数表示它们分别被放置在哪些点上。

### 样例输入输出

#### 样例输入

```
9 8 3
1 2
2 3
3 4
1 4
3 5
4 6
7 8
8 9
```

#### 样例输出

```
Possible
3
1 5 7 
```

### 数据范围

对于 $24\%$ 的数据，满足 $n\le 20,m\le 50$。

对于 $48\%$ 的数据，满足 $n\le 1000,m\le2000$。

对于 $100\%$ 的数据，满足 $n\le 10^5,m\le10^6$。

### 提示

本题开启 $\text{Special Judge}$ 和捆绑测试。

请注意，你构造的方案必须让 $\text{Special Judge}$ 不会 $\text{TLE}$。其中 $\text{Special Judge}$ 使用的是暴力标记。否则你会获得零分的好成绩。

## D. 爆了（boom）

### 题目背景

> $\text{Helloworldwuyuze}$ 参加了 $\text{7702 J-PSC}$，他迅速 $AK$ 全场。
>
> 但是，这场比赛是 $\text{CF}$ 赛制。

### 题目描述

有一道题是这样的：

> 给定 $k$，若 $x=\sum\limits_{i=0}^{\infty}a_ik^i$，其中 $a_i\in[0,k)\cap\mathbb{Z}$，则函数 $f(x) = \sum\limits_{i=0}^{\infty}a_i$。
>
> 现在，对于一个数 $x$，我们首先令 $a=x$，然后我们有如下过程：
>
> 1. 对于给定的一个数 $a$，计算 $s = f(a)$。
> 2. 若 $a=s$，则令 $g(x) = s$ 并结束。
> 3. 否则，令 $a\leftarrow f(a)$，重复操作 $1$。
>
> 于是我们计算出来了函数 $g(x)$。
>
> 题目要求你计算 $\sum\limits_{i=l}^{r}g(i^i)\pmod{p}$ 的值。
>
> **特别地，如果 $\sum\limits_{i=l}^rg(i^i)=p$，则输出 `perfect`**。

你在 $\text{hack}$ 的时候发现 $\text{Helloworldwuyuze}$ 的程序中根本没有出现 `perfect`，于是你决定构造数据卡爆他。

对于给定的 $p,k$，你需要构造出相应的 $l,r$ 使得 $\sum\limits_{i=l}^rg(i^i)=p$。

### 输入描述

**本题有多组输入。**

第一行一个数 $T$ 表示数据组数。

接下来 $T$ 行每行两个数表示 $k,p$。

### 输出描述

对于每一次询问，输出对应的 $l,r$ 或报告无解。若无解，请输出 `-1 -1`。

### 样例输入输出

#### 样例输入

```
3
10 13
10 3
2 1
```

#### 样例输出

```
2 3
-1 -1
1 1
```

### 数据范围

$$
\newcommand{\arraystretch}{1.5}
\begin{array}{c|c|c|c}\hline\hline
\textbf{Subtask} & \textbf{说明} & \textbf{时限} & \textbf{分值} \\\hline
\textsf{1} & \text{无解} & 1\text{ s} & 4 \\\hline
\textsf{2} & \text{有解且\textbf{\textsf{存在}}一组解使 }1\le l\le r\le 10^5 & 1\text{ s} & 16 \\\hline
\textsf{3} & 1\le p\le 10^7 & 1\text{ s} & 18 \\\hline
\textsf{4} & 1\le p\le 10^8 & 1\text{ s} & 24 \\\hline
\textsf{5} & \text{无特殊限制} & 1\text{ s} & 30 \\\hline
\hline
\end{array}
$$

对于 $100\%$ 的数据，$10 \leq k \leq 10^3$，$1 \leq p \leq 10^9$，$1 \leq T \leq 10$。

### 提示

本题开启 Special Judge 和捆绑测试。

你需要保证 $l = r = -1$ 或 $1 \leq l \leq r \leq 10^{18}$ 且 $r - l \leq 10^{15}$，否则 $\text{Special Judge}$ 会将你的答案判为 $0$ 分。
